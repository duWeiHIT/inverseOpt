# 热传导反演求解器参数参考手册

## 边界条件类型

### 边界条件编号对照表
```
0 - 定壁温 (FIXED_TEMPERATURE)
1 - 时变定壁温 (TIME_VARY_FIXED_TEMPERATURE)  
2 - 定热流 (FIXED_HEAT_FLUX)
3 - 对流换热 (CONVECTION)
4 - 对流换热+辐射 (CONVECTION_RADIATION)
```

### 各边界条件所需参数

#### 0 - 定壁温
- **VALUE1**: 边界温度 (°C)
- **VALUE2**: 不使用 (设为0.0)
- **VALUE3**: 不使用 (设为0.0)

#### 1 - 时变定壁温
- **VALUE1**: 不使用 (程序内部处理)
- **VALUE2**: 不使用 (设为0.0)
- **VALUE3**: 不使用 (设为0.0)

#### 2 - 定热流
- **VALUE1**: 热流密度 (W/m²)
- **VALUE2**: 不使用 (设为0.0)
- **VALUE3**: 不使用 (设为0.0)

#### 3 - 对流换热
- **VALUE1**: 环境温度 (°C)
- **VALUE2**: 换热系数 (W/m²·K)
- **VALUE3**: 不使用 (设为0.0)

#### 4 - 对流换热+辐射
- **VALUE1**: 环境温度 (°C)
- **VALUE2**: 换热系数 (W/m²·K)
- **VALUE3**: 发射率 (0-1之间的无量纲数)

## 反演算法

### 可用算法列表
程序包含两大类算法：基于梯度的算法和无梯度进化算法。

#### 进化算法（无梯度）
```
0 -- genetic_algorithm (遗传算法)
1 -- particle_swarm (粒子群优化)
2 -- cma_es (CMA-ES标准版)
3 -- cma_es_large (CMA-ES大种群版)
4 -- cma_es_small (CMA-ES小种群版)
```

#### 基于梯度的算法
```
5 -- Ceres_optimization (Ceres优化器)
     包含: Levenberg-Marquardt, Trust Region, BFGS, L-BFGS
```

**推荐**: 遗传算法适合首次使用，CMA-ES适合高精度要求

### 算法配置选项

#### 通用配置参数
- **最大迭代次数**: 算法停止的最大迭代数
- **收敛容差**: 目标函数值变化的收敛阈值

#### 遗传算法参数
- **种群大小**: 每一代的个体数量 (50-200)
- **变异率**: 基因变异的概率 (0.01-0.1)
- **交叉率**: 个体交叉的概率 (0.6-0.9)

#### 粒子群优化参数
- **种群大小**: 粒子数量 (20-100)
- **惯性权重**: 速度惯性系数 (0.4-0.9)
- **学习因子**: 个体和社会学习系数 (1.0-2.0)

#### CMA-ES参数
- **初始步长**: 搜索半径 (0.1-1.0)
- **种群大小**: 自动计算或手动设置
- **学习率**: 协方差矩阵更新速度

#### Ceres优化参数
- **函数容差**: 目标函数收敛阈值 (1e-6 到 1e-12)
- **梯度容差**: 梯度范数收敛阈值 (1e-6 到 1e-12)
- **参数容差**: 参数变化收敛阈值 (1e-6 到 1e-12)

## 求解模式

### 模式选择
```
0 - 导热计算模式
1 - 物性反演模式
```

#### 导热计算模式 (MODE = 0)
- 使用给定的材料物性进行正向导热计算
- 需要设置计算持续时间 (DURATION)
- 输出温度场随时间的演化

#### 物性反演模式 (MODE = 1)
- 基于测量数据反演材料热物性
- 需要提供温度测量文件
- 需要指定测点位置和待反演材料层
- 输出反演得到的热导率和比热

## 材料物性数据格式

### 分段线性插值数据
```
温度(°C)  热导率(W/m·K)  比热(J/kg·K)
25.0      50.0          500.0
100.0     45.0          520.0
200.0     40.0          550.0
```

### 数据要求
- 温度点按升序排列
- 至少需要2个数据点
- 热导率和比热必须为正值
- 温度范围应覆盖计算域的温度变化范围

## 测量数据文件格式

### 标准格式
```
# 温度测量数据文件
# 格式: 时间(s) 温度(°C)
0.0  25.0
0.1  28.5
0.2  32.1
0.3  35.8
```

### 文件要求
- 以#开头的行为注释
- 数据格式: 时间 温度
- 时间点按升序排列
- 时间步长应与求解器时间步长匹配或为其整数倍

## 配置文件示例

### 单层材料完整配置
```
# 几何参数
LENGTH 0.01
NODES 50

# 边界条件
LEFT_BC_TYPE 0
LEFT_BC_VALUE1 100.0
LEFT_BC_VALUE2 0.0
LEFT_BC_VALUE3 0.0

RIGHT_BC_TYPE 3
RIGHT_BC_VALUE1 25.0
RIGHT_BC_VALUE2 10.0
RIGHT_BC_VALUE3 0.0

# 材料属性
DENSITY 7800.0

# 材料数据
MATERIAL_DATA_START
25.0  50.0  500.0
100.0 45.0  520.0
200.0 40.0  550.0
MATERIAL_DATA_END

# 时间参数
TIME_STEP 0.1
INITIAL_TEMP 25.0

# 求解参数
SOLVE_MODE 1
DURATION 10.0

# 反演参数
MEASUREMENT_FILE "measurement.txt"
MEASURE_POSITION 0.005
ALGORITHM_INDEX 0
USE_DEFAULT_CONFIG true
```

### 多层材料配置要点
- 每层需要独立的NAME, THICKNESS, NODES, DENSITY配置
- 每层需要独立的材料数据块 (LAYER1_DATA_START/END)
- 反演时需要指定SAMPLE_INDEX (待反演层编号)

## 常见问题与解决方案

### 1. 边界条件设置错误
**问题**: 程序运行异常或结果不合理
**解决**: 检查边界条件类型与参数的匹配关系

### 2. 算法不收敛
**问题**: 反演算法达到最大迭代次数但未收敛
**解决**: 
- 调整算法参数 (容差、最大迭代次数)
- 尝试不同的算法
- 检查初始猜测值的合理性

### 3. 测量数据格式错误
**问题**: 无法读取测量文件
**解决**: 
- 确保文件格式正确 (时间 温度)
- 检查文件路径
- 确认数据点数量足够

### 4. 材料数据超出范围
**问题**: 计算过程中温度超出材料数据范围
**解决**: 扩展材料物性数据的温度范围

## 单位制说明

### 长度单位: 米 (m)
### 时间单位: 秒 (s)  
### 温度单位: 摄氏度 (°C)
### 热导率单位: W/m·K
### 比热单位: J/kg·K
### 密度单位: kg/m³
### 换热系数单位: W/m²·K
### 热流密度单位: W/m²